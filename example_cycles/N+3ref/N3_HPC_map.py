import numpy as np

from pycycle.maps.map_data import MapData


"""Python version of HBTF HPC map from NPSS"""
HPCMap = MapData()

# Map design point values
HPCMap.defaults = {}
HPCMap.defaults['alphaMap'] = 0.0
HPCMap.defaults['NcMap'] = 1.00
HPCMap.defaults['PR'] = 23.00
HPCMap.defaults['RlineMap'] = 2.0
HPCMap.RlineStall = 1.0

HPCMap.alphaMap = np.array([0.000, 90.000])
HPCMap.NcMap = np.array([0.500, 0.600, 0.700, 0.750, 0.800, 0.850, 0.900, 0.925, 0.950, 0.975, 1.000, 1.025, 1.050])
HPCMap.RlineMap = np.array([1.000, 1.200, 1.400, 1.600, 1.800, 2.000, 2.200, 2.400, 2.600, 2.800, 3.000]) 

HPCMap.WcMap = np.array([[[ 22.7411,  24.0487,  25.1548,  26.0615,  26.7738,  27.2992, 27.6470,  27.8286,  27.8634,  27.8634,  27.8634],
  [ 31.7548,  33.1181,  34.2670,  35.2054,  35.9397,  36.4783, 36.8308,  37.0085,  37.0362,  37.0362,  37.0362],
  [ 46.1066,  47.4088,  48.5066,  49.4046,  50.1096,  50.6291, 50.9717,  51.1469,  51.1757,  51.1757,  51.1757],
  [ 56.7268,  58.0480,  59.1608,  60.0704,  60.7837,  61.3084, 61.6527,  61.8260,  61.8517,  61.8517,  61.8517],
  [ 70.1448,  71.5163,  72.6688,  73.6088,  74.3429,  74.8795, 75.2269,  75.3943,  75.4134,  75.4134,  75.4134],
  [ 89.3764,  90.9746,  92.3098,  93.3900,  94.2232,  94.8199, 95.1897,  95.3442,  95.3504,  95.3504,  95.3504],
  [118.0620, 120.1207, 121.8253, 123.1867, 124.2166, 124.9292, 125.3385, 125.4609, 125.4609, 125.4609, 125.4609],
  [138.5093, 140.8966, 142.8639, 144.4238, 145.5916, 146.3836, 146.8174, 146.9192, 146.9192, 146.9192, 146.9192],
  [160.6243, 162.5676, 164.1805, 165.4722, 166.4536, 167.1370, 167.5334, 167.6563, 167.6563, 167.6563, 167.6563],
  [181.7993, 183.4993, 184.9150, 186.0545, 186.9260, 187.5389, 187.9029, 188.0273, 188.0271, 188.0271, 188.0271],
  [202.6315, 203.5858, 204.3958, 205.0661, 205.5998, 206.0000, 206.2702, 206.4145, 206.4418, 206.4418, 206.4418],
  [209.9986, 210.5917, 211.1029, 211.5321, 211.8825, 212.1554, 212.3516, 212.4735, 212.5220, 212.5227, 212.5227],
  [216.6847, 217.0279, 217.3287, 217.5860, 217.8015, 217.9767, 218.1106, 218.2041, 218.2586, 218.2739, 218.2739]],
  [[ 45.5139,  47.7923,  49.6744,  51.1682,  52.2877,  53.0508, 53.4791,  53.5986,  53.5986,  53.5986,  53.5986],
  [ 61.9648,  64.2862,  66.1998,  67.7166,  68.8513,  69.6225, 70.0509,  70.1629,  70.1629,  70.1629,  70.1629],
  [ 84.8030,  86.9149,  88.6608,  90.0516,  91.1005,  91.8227, 92.2351,  92.3561,  92.3561,  92.3561,  92.3561],
  [100.0799, 102.1580, 103.8778, 105.2502, 106.2882, 107.0060, 107.4188, 107.5439, 107.5439, 107.5439, 107.5439],
  [116.8091, 118.8724, 120.5804, 121.9443, 122.9763, 123.6901, 124.1001, 124.2228, 124.2228, 124.2228, 124.2228],
  [135.6708, 137.9187, 139.7752, 141.2518, 142.3627, 143.1228, 143.5481, 143.6591, 143.6591, 143.6591, 143.6591],
  [157.0283, 159.6273, 161.7610, 163.4443, 164.6937, 165.5281, 165.9667, 166.0495, 166.0495, 166.0495, 166.0495],
  [167.7171, 170.4948, 172.7683, 174.5537, 175.8698, 176.7370, 177.1761, 177.2440, 177.2440, 177.2440, 177.2440],
  [180.5349, 182.6532, 184.4021, 185.7931, 186.8382, 187.5511, 187.9446, 188.0393, 188.0393, 188.0393, 188.0393],
  [191.1595, 192.9175, 194.3772, 195.5477, 196.4376, 197.0574, 197.4157, 197.5237, 197.5237, 197.5237, 197.5237],
  [202.6315, 203.5858, 204.3958, 205.0661, 205.5998, 206.0000, 206.2702, 206.4145, 206.4418, 206.4418, 206.4418],
  [209.9986, 210.5917, 211.1029, 211.5321, 211.8825, 212.1554, 212.3516, 212.4735, 212.5220, 212.5227, 212.5227],
  [216.6847, 217.0279, 217.3287, 217.5860, 217.8015, 217.9767, 218.1106, 218.2041, 218.2586, 218.2739, 218.2739]]])

HPCMap.effMap = np.array([[[0.6753, 0.6913, 0.7016, 0.7050, 0.7004, 0.6864, 0.6570, 0.6044, 0.5236, 0.4075, 0.2467],
  [0.6953, 0.7094, 0.7184, 0.7214, 0.7176, 0.7058, 0.6812, 0.6378, 0.5717, 0.4783, 0.3512],
  [0.7248, 0.7359, 0.7429, 0.7452, 0.7424, 0.7335, 0.7154, 0.6838, 0.6366, 0.5713, 0.4848],
  [0.7427, 0.7533, 0.7600, 0.7627, 0.7606, 0.7533, 0.7379, 0.7108, 0.6703, 0.6147, 0.5414],
  [0.7634, 0.7736, 0.7804, 0.7834, 0.7822, 0.7762, 0.7630, 0.7394, 0.7041, 0.6556, 0.5920],
  [0.7891, 0.8008, 0.8090, 0.8134, 0.8136, 0.8092, 0.7974, 0.7754, 0.7417, 0.6950, 0.6335],
  [0.8139, 0.8280, 0.8385, 0.8449, 0.8469, 0.8439, 0.8333, 0.8117, 0.7779, 0.7303, 0.6671],
  [0.8206, 0.8356, 0.8469, 0.8541, 0.8567, 0.8544, 0.8442, 0.8229, 0.7892, 0.7416, 0.6783],
  [0.8403, 0.8512, 0.8593, 0.8643, 0.8660, 0.8641, 0.8566, 0.8415, 0.8179, 0.7852, 0.7423],
  [0.8408, 0.8492, 0.8552, 0.8588, 0.8597, 0.8578, 0.8516, 0.8394, 0.8209, 0.7954, 0.7624],
  [0.8470, 0.8505, 0.8529, 0.8539, 0.8536, 0.8520, 0.8483, 0.8418, 0.8324, 0.8200, 0.8043],
  [0.8350, 0.8364, 0.8371, 0.8370, 0.8362, 0.8346, 0.8318, 0.8275, 0.8217, 0.8141, 0.8049],
  [0.8202, 0.8203, 0.8201, 0.8195, 0.8185, 0.8171, 0.8152, 0.8124, 0.8088, 0.8045, 0.7992]],
  [[0.6993, 0.7223, 0.7389, 0.7480, 0.7483, 0.7382, 0.7110, 0.6580, 0.5734, 0.4498, 0.2768],
  [0.7294, 0.7502, 0.7653, 0.7739, 0.7751, 0.7676, 0.7460, 0.7036, 0.6363, 0.5394, 0.4062],
  [0.7720, 0.7887, 0.8009, 0.8080, 0.8094, 0.8044, 0.7892, 0.7592, 0.7121, 0.6454, 0.5558],
  [0.7928, 0.8080, 0.8192, 0.8259, 0.8276, 0.8237, 0.8109, 0.7855, 0.7457, 0.6896, 0.6147],
  [0.8125, 0.8267, 0.8372, 0.8436, 0.8456, 0.8426, 0.8318, 0.8099, 0.7757, 0.7275, 0.6635],
  [0.8214, 0.8356, 0.8463, 0.8529, 0.8553, 0.8528, 0.8429, 0.8224, 0.7901, 0.7446, 0.6843],
  [0.8276, 0.8430, 0.8546, 0.8622, 0.8652, 0.8633, 0.8537, 0.8332, 0.8005, 0.7544, 0.6931],
  [0.8245, 0.8403, 0.8521, 0.8599, 0.8630, 0.8611, 0.8514, 0.8306, 0.7975, 0.7507, 0.6887],
  [0.8341, 0.8451, 0.8531, 0.8581, 0.8598, 0.8578, 0.8504, 0.8352, 0.8117, 0.7790, 0.7364],
  [0.8379, 0.8463, 0.8523, 0.8559, 0.8568, 0.8549, 0.8486, 0.8365, 0.8179, 0.7925, 0.7596],
  [0.8470, 0.8505, 0.8529, 0.8539, 0.8536, 0.8520, 0.8483, 0.8418, 0.8324, 0.8200, 0.8043],
  [0.8350, 0.8364, 0.8371, 0.8370, 0.8362, 0.8346, 0.8318, 0.8275, 0.8217, 0.8141, 0.8049],
  [0.8202, 0.8203, 0.8201, 0.8195, 0.8185, 0.8171, 0.8152, 0.8124, 0.8088, 0.8045, 0.7992]]])

HPCMap.PRmap = np.array([[[ 2.4769,  2.4288,  2.3620,  2.2778,  2.1774,  2.0627, 1.9284,  1.7711,  1.5958,  1.4083,  1.2146],
  [ 3.4633,  3.3778,  3.2643,  3.1248,  2.9619,  2.7787, 2.5679,  2.3253,  2.0595,  1.7802,  1.4973],
  [ 5.0821,  4.9375,  4.7554,  4.5391,  4.2923,  4.0194, 3.7106,  3.3602,  2.9800,  2.5826,  2.1813],
  [ 6.3490,  6.1658,  5.9371,  5.6667,  5.3594,  5.0204, 4.6377,  4.2042,  3.7342,  3.2431,  2.7467],
  [ 8.0021,  7.7686,  7.4792,  7.1388,  6.7532,  6.3287, 5.8504,  5.3097,  4.7237,  4.1114,  3.4919],
  [10.4899, 10.1976,  9.8249,  9.3786,  8.8669,  8.2989, 7.6539,  6.9201,  6.1229,  5.2899,  4.4495],
  [14.4564, 14.0970, 13.6074, 12.9977, 12.2808, 11.4715, 10.5377,  9.4621,  8.2878,  7.0614,  5.8306],
  [17.4426, 17.0500, 16.4870, 15.7661, 14.9034, 13.9183, 12.7692, 11.4347,  9.9718,  8.4425,  6.9104],
  [20.7403, 20.2486, 19.6093, 18.8329, 17.9324, 16.9227, 15.7626, 14.4263, 12.9562, 11.3983,  9.8011],
  [23.8298, 23.2601, 22.5536, 21.7200, 20.7705, 19.7178, 18.5212, 17.1524, 15.6466, 14.0424, 12.3810],
  [26.6962, 26.0933, 25.4175, 24.6733, 23.8656, 22.9999, 22.0495, 20.9930, 19.8436, 18.6163, 17.3267],
  [27.6439, 27.0687, 26.4522, 25.7969, 25.1052, 24.3798, 23.6033, 22.7614, 21.8600, 20.9058, 19.9057],
  [28.4663, 27.9667, 27.4460, 26.9054, 26.3460, 25.7690, 25.1640, 24.5225, 23.8472, 23.1399, 22.4038]],
  [[ 5.5200,  5.4081,  5.2155,  4.9486,  4.6162,  4.2292, 3.7722,  3.2417,  2.6710,  2.0954,  1.5493],
  [ 7.5640,  7.3974,  7.1268,  6.7607,  6.3104,  5.7900, 5.1790,  4.4722,  3.7116,  2.9418,  2.2066],
  [10.2643, 10.0087,  9.6410,  9.1703,  8.6086,  7.9699, 7.2293,  6.3765,  5.4525,  4.5013,  3.5672],
  [12.0520, 11.7493, 11.3275, 10.7965, 10.1683,  9.4573, 8.6354,  7.6892,  6.6601,  5.5926,  4.5321],
  [14.2753, 13.9203, 13.4356, 12.8317, 12.1210, 11.3187, 10.3925,  9.3260,  8.1618,  6.9465,  5.7278],
  [16.9112, 16.5159, 15.9649, 15.2698, 14.4454, 13.5091, 12.4221, 11.1638,  9.7852,  8.3414,  6.8896],
  [20.7368, 20.3081, 19.6692, 18.8350, 17.8246, 16.6613, 15.2936, 13.6955, 11.9366, 10.0936,  8.2454],
  [22.5680, 22.1257, 21.4443, 20.5401, 19.4347, 18.1546, 16.6421, 14.8683, 12.9140, 10.8676,  8.8203],
  [24.1283, 23.5795, 22.8503, 21.9531, 20.9035, 19.7197, 18.3522, 16.7697, 15.0246, 13.1743, 11.2785],
  [25.7180, 25.1128, 24.3564, 23.4593, 22.4338, 21.2942, 19.9953, 18.5065, 16.8666, 15.1186, 13.3083],
  [26.6962, 26.0933, 25.4175, 24.6733, 23.8656, 22.9999, 22.0495, 20.9930, 19.8436, 18.6163, 17.3267],
  [27.6439, 27.0687, 26.4522, 25.7969, 25.1052, 24.3798, 23.6033, 22.7614, 21.8600, 20.9058, 19.9057],
  [28.4663, 27.9667, 27.4460, 26.9054, 26.3460, 25.7690, 25.1640, 24.5225, 23.8472, 23.1399, 22.4038]]])

#HPCMap.Nc_data, HPCMap.alpha_data, HPCMap.Rline_data = np.meshgrid(HPCMap.Nc_vals, HPCMap.alpha_vals, HPCMap.Rline_vals, sparse=False)
HPCMap.Npts = HPCMap.NcMap.size

HPCMap.units = {}
HPCMap.units['NcMap'] = 'rpm'
HPCMap.units['WcMap'] = 'lbm/s'

# format for new regular grid interpolator:

HPCMap.param_data = []
HPCMap.output_data = []

HPCMap.param_data.append({'name': 'alphaMap', 'values': HPCMap.alphaMap,
                          'default': 0, 'units': None})
HPCMap.param_data.append({'name': 'NcMap', 'values': HPCMap.NcMap,
                          'default': 1.0, 'units': 'rpm'})
HPCMap.param_data.append({'name': 'RlineMap', 'values': HPCMap.RlineMap,
                          'default': 2.00, 'units': None})

HPCMap.output_data.append({'name': 'WcMap', 'values': HPCMap.WcMap,
                           'default': np.mean(HPCMap.WcMap), 'units': 'lbm/s'})
HPCMap.output_data.append({'name': 'effMap', 'values': HPCMap.effMap,
                           'default': np.mean(HPCMap.effMap), 'units': None})
HPCMap.output_data.append({'name': 'PRmap', 'values': HPCMap.PRmap,
                           'default': 23.0, 'units': None})
